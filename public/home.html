<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FlexiCAD Designer - Home</title>
    <link rel="stylesheet" href="css/dark-theme.css">
</head>
<body>
    <!-- Navigation will be managed by navbar-manager.js -->

    <div class="container">
        <div class="page-header">
            <h1 class="page-title">Welcome to FlexiCAD Designer</h1>
            <p class="page-subtitle">Your AI-powered 3D design companion for creating stunning OpenSCAD models</p>
        </div>

        <div class="card-grid">
            <div class="card">
                <div class="card-title">ðŸ¤– AI Generator</div>
                <div class="card-description">
                    Describe your 3D design in plain English and let our AI generate OpenSCAD code for you. 
                    Perfect for rapid prototyping and exploring new ideas.
                </div>
                <div class="card-actions">
                    <a href="ai.html" class="btn btn-primary">Start Creating</a>
                </div>
            </div>

            <div class="card">
                <div class="card-title">ðŸ“š Template Library</div>
                <div class="card-description">
                    Browse our curated collection of OpenSCAD templates. From Arduino cases to automotive parts, 
                    find the perfect starting point for your project.
                </div>
                <div class="card-actions">
                    <a href="templates.html" class="btn btn-secondary">Browse Templates</a>
                </div>
            </div>

            <div class="card">
                <div class="card-title">ðŸ’¾ My Designs</div>
                <div class="card-description">
                    Access all your saved designs, AI-generated creations, and custom modifications. 
                    Organize and manage your 3D design portfolio.
                </div>
                <div class="card-actions">
                    <a href="my-designs.html" class="btn btn-secondary">View Designs</a>
                </div>
            </div>

            <div class="card">
                <div class="card-title">âš¡ Quick Start</div>
                <div class="card-description">
                    New to FlexiCAD? Start with our popular templates or try the AI generator with simple prompts 
                    like "design a phone case" or "create a desk organizer".
                </div>
                <div class="card-actions">
                    <a href="templates.html" class="btn btn-secondary btn-small">Templates</a>
                    <a href="ai.html" class="btn btn-primary btn-small">Try AI</a>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="js/secure-config-loader.js"></script>
    <script src="js/flexicad-auth.js"></script>
    <script src="js/navbar-manager.js"></script>
    <script>
        // Initialize authentication for this page
        document.addEventListener('DOMContentLoaded', async function() {
            // Check if user has paid access
            const hasAccess = await window.flexicadAuth.requireAuth();
            
            if (hasAccess) {
                console.log('User has paid access');
                
                // Display user info
                const userInfo = document.getElementById('userInfo');
                if (window.flexicadAuth.user && userInfo) {
                    userInfo.textContent = window.flexicadAuth.user.email || 'User';
                }

                // Check URL for checkout success
                const urlStatus = window.flexicadAuth.checkURLParams();
                if (urlStatus && urlStatus.type === 'checkout_success') {
                    // Show success message
                    const successBanner = document.createElement('div');
                    successBanner.className = 'alert alert-success';
                    successBanner.textContent = urlStatus.message;
                    successBanner.style.cssText = 'margin-bottom: 1rem; padding: 1rem; text-align: center;';
                    document.querySelector('.container').insertBefore(successBanner, document.querySelector('.page-header'));
                    
                    // Auto-hide after 5 seconds
                    setTimeout(() => {
                        successBanner.remove();
                    }, 5000);
                }
            }
        });

        function handleLogout() {
            window.flexicadAuth.logout();
        }
    </script>
</body>
</html>